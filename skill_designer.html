<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ€èƒ½è®¾è®¡å™¨ - ç”µå­ç›†æ ½</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1e3a8a 0%, #312e81 100%);
            min-height: 100vh;
            font-family: 'Inter', sans-serif;
        }
        
        .skill-card {
            transition: all 0.3s ease;
        }
        
        .skill-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .category-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        /* ç³»åˆ«é¢œè‰² */
        .element-water { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .element-fire { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .element-grass { background: linear-gradient(135deg, #22c55e, #16a34a); }
        .element-wind { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .element-electric { background: linear-gradient(135deg, #eab308, #ca8a04); }
        .element-earth { background: linear-gradient(135deg, #a16207, #854d0e); }
        
        /* å˜å¼‚é¢œè‰² */
        .mutation-dark { background: linear-gradient(135deg, #1f2937, #111827); }
        .mutation-light { background: linear-gradient(135deg, #f3f4f6, #e5e7eb); color: #111827; }
        .mutation-crystal { background: linear-gradient(135deg, #a78bfa, #8b5cf6); }
        .mutation-shadow { background: linear-gradient(135deg, #4b5563, #374151); }
        .mutation-thunder { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
        .mutation-holy { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #92400e; }
        .mutation-psychic { background: linear-gradient(135deg, #ec4899, #db2777); }
        .mutation-chaos { background: linear-gradient(135deg, #581c87, #6b21a8); }
        .mutation-eternal-dark { background: linear-gradient(135deg, #0f172a, #020617); }
        .mutation-eternal-light { background: linear-gradient(135deg, #fef9c3, #fef08a); color: #713f12; }
        .mutation-source-crystal { background: linear-gradient(135deg, #5b21b6, #6d28d9); }
        .mutation-thunder-lord { background: linear-gradient(135deg, #f59e0b, #d97706); }
        
        /* ç¨€æœ‰åº¦é¢œè‰² */
        .rarity-shiny { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
        .rarity-prismatic { background: linear-gradient(135deg, #ec4899, #8b5cf6, #3b82f6); }
        .rarity-stellar { background: linear-gradient(135deg, #fef3c7, #fde68a, #fbbf24); color: #92400e; }
        
        .emoji-picker {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 0.5rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .emoji-btn {
            padding: 0.5rem;
            font-size: 1.5rem;
            cursor: pointer;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        
        .emoji-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: scale(1.2);
        }

        .param-group {
            display: none;
        }

        .param-group.active {
            display: block;
        }
    </style>
</head>
<body class="p-6">
    <div class="max-w-7xl mx-auto">
        <!-- æ ‡é¢˜ -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">âš”ï¸ æŠ€èƒ½è®¾è®¡å™¨ âš”ï¸</h1>
            <p class="text-blue-200 mb-3">ç²¾ç¡®è®¾è®¡æˆ˜æ–—æŠ€èƒ½çš„æ¯ä¸ªå‚æ•°</p>
            <div class="flex justify-center gap-3">
                <a href="skill_viewer.html"
                   class="inline-flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">
                    <span>ğŸ¯</span>
                    <span>æŸ¥çœ‹æŠ€èƒ½æ± </span>
                </a>
                <button onclick="window.history.back()"
                        class="inline-flex items-center gap-2 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg transition-colors">
                    <span>â†</span>
                    <span>è¿”å›</span>
                </button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- å·¦ä¾§ï¼šæŠ€èƒ½è®¾è®¡è¡¨å• -->
            <div class="lg:col-span-2 bg-gray-900/80 backdrop-blur-lg rounded-xl p-6 border border-gray-700">
                <h2 class="text-2xl font-bold text-white mb-6">ğŸ¨ åˆ›å»ºæ–°æŠ€èƒ½</h2>
                
                <form id="skill-form" class="space-y-4">
                    <!-- åŸºç¡€ä¿¡æ¯ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">æŠ€èƒ½åç§° *</label>
                            <input type="text" id="skill-name" required
                                class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">æŠ€èƒ½å›¾æ ‡ *</label>
                            <div class="flex gap-2">
                                <input type="text" id="skill-icon" required maxlength="2"
                                    class="flex-1 bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white text-center text-2xl focus:outline-none focus:border-blue-500">
                                <button type="button" id="emoji-picker-btn"
                                    class="bg-blue-600 hover:bg-blue-700 text-white px-4 rounded-lg">
                                    é€‰æ‹©
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- æŠ€èƒ½æè¿° -->
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">æŠ€èƒ½æè¿°</label>
                        <textarea id="skill-description" rows="2" placeholder="æè¿°è¿™ä¸ªæŠ€èƒ½çš„èƒŒæ™¯æ•…äº‹æˆ–ç‰¹ç‚¹..."
                            class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500 resize-none"></textarea>
                    </div>

                    <!-- æŠ€èƒ½ç±»åˆ«å’Œç¨€æœ‰åº¦ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">æŠ€èƒ½ç±»åˆ« *</label>
                            <select id="skill-category" required
                                class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500">
                                <option value="">é€‰æ‹©ç±»åˆ«</option>
                                <optgroup label="ç³»åˆ«æŠ€èƒ½">
                                    <option value="element-water">ğŸ’§ æ°´ç³»</option>
                                    <option value="element-fire">ğŸ”¥ ç«ç³»</option>
                                    <option value="element-grass">ğŸŒ¿ è‰ç³»</option>
                                    <option value="element-wind">ğŸ’¨ é£ç³»</option>
                                    <option value="element-electric">âš¡ ç”µç³»</option>
                                    <option value="element-earth">ğŸª¨ åœŸç³»</option>
                                </optgroup>
                                <optgroup label="å˜å¼‚æŠ€èƒ½ - åŸºç¡€çº§">
                                    <option value="mutation-dark">ğŸ–¤ é»‘åŒ–</option>
                                    <option value="mutation-light">ğŸ¤ ç™½åŒ–</option>
                                    <option value="mutation-crystal">ğŸ’ æ™¶åŒ–</option>
                                    <option value="mutation-shadow">ğŸ‘¤ å½±åŒ–</option>
                                </optgroup>
                                <optgroup label="å˜å¼‚æŠ€èƒ½ - ç²¾è‹±çº§">
                                    <option value="mutation-chaos">ğŸŒ‘ æš—èš€</option>
                                    <option value="mutation-holy">âœ¨ åœ£è¾‰</option>
                                    <option value="mutation-psychic">ğŸ”® å¼‚èƒ½</option>
                                    <option value="mutation-thunder">âš¡ æç”µ</option>
                                </optgroup>
                                <optgroup label="å˜å¼‚æŠ€èƒ½ - ä¼ è¯´çº§">
                                    <option value="mutation-eternal-dark">ğŸŒ™ æ°¸å¤œ</option>
                                    <option value="mutation-eternal-light">â˜€ï¸ æ°¸è€€</option>
                                    <option value="mutation-source-crystal">ğŸ’  æºæ™¶</option>
                                    <option value="mutation-thunder-lord">âš¡ é›·ç…Œ</option>
                                </optgroup>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">ç¨€æœ‰åº¦ï¼ˆå¯é€‰ï¼‰</label>
                            <select id="skill-rarity"
                                class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500">
                                <option value="">æ— </option>
                                <option value="shiny">âœ¨ é—ªå…‰</option>
                                <option value="prismatic">ğŸŒˆ å¹»å½©</option>
                                <option value="stellar">â­ æ˜ŸèŠ’</option>
                            </select>
                        </div>
                    </div>

                    <!-- æŠ€èƒ½ç±»å‹ï¼ˆå¤šé€‰ï¼‰ -->
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">æŠ€èƒ½ç±»å‹ * (å¯å¤šé€‰)</label>
                        <div id="skill-types" class="bg-gray-800 border border-gray-600 rounded-lg p-3 grid grid-cols-2 gap-2">
                            <label class="flex items-center gap-2 text-white cursor-pointer hover:bg-gray-700 p-2 rounded">
                                <input type="checkbox" name="skill-type" value="attack" class="skill-type-checkbox">
                                <span>âš”ï¸ æ”»å‡»å‹</span>
                            </label>
                            <label class="flex items-center gap-2 text-white cursor-pointer hover:bg-gray-700 p-2 rounded">
                                <input type="checkbox" name="skill-type" value="defense" class="skill-type-checkbox">
                                <span>ğŸ›¡ï¸ é˜²å¾¡å‹</span>
                            </label>
                            <label class="flex items-center gap-2 text-white cursor-pointer hover:bg-gray-700 p-2 rounded">
                                <input type="checkbox" name="skill-type" value="agility" class="skill-type-checkbox">
                                <span>âš¡ æ•æ·å‹</span>
                            </label>
                            <label class="flex items-center gap-2 text-white cursor-pointer hover:bg-gray-700 p-2 rounded">
                                <input type="checkbox" name="skill-type" value="buff" class="skill-type-checkbox">
                                <span>ğŸ’ª å¢ç›Šå‹</span>
                            </label>
                            <label class="flex items-center gap-2 text-white cursor-pointer hover:bg-gray-700 p-2 rounded">
                                <input type="checkbox" name="skill-type" value="debuff" class="skill-type-checkbox">
                                <span>ğŸ”» å‡ç›Šå‹</span>
                            </label>
                            <label class="flex items-center gap-2 text-white cursor-pointer hover:bg-gray-700 p-2 rounded">
                                <input type="checkbox" name="skill-type" value="heal" class="skill-type-checkbox">
                                <span>ğŸ’š æ²»ç–—å‹</span>
                            </label>
                        </div>
                    </div>

                    <!-- æŠ€èƒ½æ•ˆæœï¼ˆå¤šé€‰ï¼‰ -->
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">æŠ€èƒ½æ•ˆæœ * (å¯å¤šé€‰)</label>
                        <div id="skill-effects" class="bg-gray-800 border border-gray-600 rounded-lg p-3 max-h-96 overflow-y-auto space-y-3">
                            <!-- æ”»å‡»ç±» -->
                            <div>
                                <div class="text-xs font-bold text-blue-400 mb-2">æ”»å‡»ç±»</div>
                                <div class="grid grid-cols-2 gap-2">
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="direct_attack" class="skill-effect-checkbox">
                                        <span>ç›´æ¥æ”»å‡»</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="multi_attack" class="skill-effect-checkbox">
                                        <span>å¤šæ®µæ”»å‡»</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="dot_damage" class="skill-effect-checkbox">
                                        <span>é™„åŠ ä¼¤å®³(æŒç»­)</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="percent_damage" class="skill-effect-checkbox">
                                        <span>ç™¾åˆ†æ¯”ä¼¤å®³</span>
                                    </label>
                                </div>
                            </div>
                            <!-- é˜²å¾¡ç±» -->
                            <div>
                                <div class="text-xs font-bold text-green-400 mb-2">é˜²å¾¡ç±»</div>
                                <div class="grid grid-cols-2 gap-2">
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="direct_defense" class="skill-effect-checkbox">
                                        <span>ç›´æ¥é˜²å¾¡</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="continuous_defense" class="skill-effect-checkbox">
                                        <span>æŒç»­é˜²å¾¡</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="defense_counter" class="skill-effect-checkbox">
                                        <span>é˜²å¾¡åå‡»</span>
                                    </label>
                                </div>
                            </div>
                            <!-- æ•æ·ç±» -->
                            <div>
                                <div class="text-xs font-bold text-yellow-400 mb-2">æ•æ·ç±»</div>
                                <div class="grid grid-cols-2 gap-2">
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="direct_speed" class="skill-effect-checkbox">
                                        <span>ç›´æ¥å¢é€Ÿ</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="continuous_speed" class="skill-effect-checkbox">
                                        <span>æŒç»­å¢é€Ÿ</span>
                                    </label>
                                </div>
                            </div>
                            <!-- å¢ç›Šç±» -->
                            <div>
                                <div class="text-xs font-bold text-purple-400 mb-2">å¢ç›Šç±»</div>
                                <div class="grid grid-cols-2 gap-2">
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="buff_attack" class="skill-effect-checkbox">
                                        <span>å¢æ”»</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="buff_defense" class="skill-effect-checkbox">
                                        <span>å¢é˜²</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="buff_speed" class="skill-effect-checkbox">
                                        <span>å¢é€Ÿ</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="buff_status_enemy" class="skill-effect-checkbox">
                                        <span>ä¸ºæ•Œæ–¹é™„åŠ å¼‚å¸¸</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="buff_purify" class="skill-effect-checkbox">
                                        <span>å‡€åŒ–</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="buff_heal_amp" class="skill-effect-checkbox">
                                        <span>å¢åŠ æ²»ç–—é‡</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="buff_element_damage" class="skill-effect-checkbox">
                                        <span>å±æ€§å¢ä¼¤</span>
                                    </label>
                                </div>
                            </div>
                            <!-- å‡ç›Šç±» -->
                            <div>
                                <div class="text-xs font-bold text-red-400 mb-2">å‡ç›Šç±»</div>
                                <div class="grid grid-cols-2 gap-2">
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="debuff_attack" class="skill-effect-checkbox">
                                        <span>å‡æ”»</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="debuff_defense" class="skill-effect-checkbox">
                                        <span>å‡é˜²</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="debuff_speed" class="skill-effect-checkbox">
                                        <span>å‡é€Ÿ</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="debuff_status_self" class="skill-effect-checkbox">
                                        <span>ä¸ºè‡ªèº«é™„åŠ å¼‚å¸¸</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="debuff_no_heal" class="skill-effect-checkbox">
                                        <span>ç¦ç–—</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="debuff_heal_reduce" class="skill-effect-checkbox">
                                        <span>å‡ç–—</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="debuff_element_damage" class="skill-effect-checkbox">
                                        <span>å±æ€§å‡ä¼¤</span>
                                    </label>
                                </div>
                            </div>
                            <!-- æ²»ç–—ç±» -->
                            <div>
                                <div class="text-xs font-bold text-pink-400 mb-2">æ²»ç–—ç±»</div>
                                <div class="grid grid-cols-2 gap-2">
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="heal_direct" class="skill-effect-checkbox">
                                        <span>ç›´æ¥æ¢å¤</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="heal_continuous" class="skill-effect-checkbox">
                                        <span>æŒç»­æ¢å¤</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="heal_percent" class="skill-effect-checkbox">
                                        <span>ç™¾åˆ†æ¯”æ¢å¤</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="heal_rebirth" class="skill-effect-checkbox">
                                        <span>é‡ç”Ÿ</span>
                                    </label>
                                    <label class="flex items-center gap-2 text-white text-sm cursor-pointer hover:bg-gray-700 p-1.5 rounded">
                                        <input type="checkbox" name="skill-effect" value="heal_lifesteal" class="skill-effect-checkbox">
                                        <span>ç”Ÿå‘½æ±²å–</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- åŠ¨æ€å‚æ•°åŒºåŸŸ -->
                    <div id="params-container" class="space-y-4 bg-gray-800/50 rounded-lg p-4 border border-gray-600">
                        <h3 class="text-sm font-bold text-gray-300 mb-3">ğŸ“Š æŠ€èƒ½å‚æ•°</h3>
                        
                        <!-- é€šç”¨å‚æ•° -->
                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-400 mb-1">å†·å´å›åˆ</label>
                                <input type="number" id="param-cooldown" min="0" value="0"
                                    class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-400 mb-1">æŒç»­å›åˆ</label>
                                <input type="number" id="param-duration" min="0" value="0"
                                    class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-400 mb-1">æ¬¡æ•°</label>
                                <input type="number" id="param-count" min="1" value="1"
                                    class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                            </div>
                        </div>

                        <!-- æ”»å‡»åŠ æˆå‚æ•° -->
                        <div id="param-attack-bonus-group" class="param-group">
                            <label class="block text-xs font-medium text-gray-400 mb-1">æ”»å‡»åŠ æˆ</label>
                            <input type="number" id="param-attack-bonus" step="0.01" min="0" value="1.0"
                                class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                            <p class="text-xs text-gray-500 mt-1">ä¼¤å®³ = è‡ªèº«æ”»å‡»åŠ› Ã— æ”»å‡»åŠ æˆ</p>
                        </div>

                        <!-- å¤šæ®µæ”»å‡»åŠ æˆ -->
                        <div id="param-multi-bonus-group" class="param-group">
                            <label class="block text-xs font-medium text-gray-400 mb-1">å¤šæ®µæ”»å‡»åŠ æˆ(é€—å·åˆ†éš”)</label>
                            <input type="text" id="param-multi-bonus" placeholder="ä¾‹: 0.5,0.7,1.0"
                                class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                            <p class="text-xs text-gray-500 mt-1">æ¯æ®µä¼¤å®³ = æ”»å‡»åŠ› Ã— å¯¹åº”åŠ æˆ</p>
                        </div>

                        <!-- ç™¾åˆ†æ¯”ä¼¤å®³å‚æ•° -->
                        <div id="param-percent-damage-group" class="param-group">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">ä¼¤å®³æ¥æº</label>
                                    <select id="param-damage-source"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="self-attack">æˆ‘æ–¹æ”»å‡»</option>
                                        <option value="self-defense">æˆ‘æ–¹é˜²å¾¡</option>
                                        <option value="self-speed">æˆ‘æ–¹é€Ÿåº¦</option>
                                        <option value="self-hp">æˆ‘æ–¹ç”Ÿå‘½</option>
                                        <option value="enemy-attack">æ•Œæ–¹æ”»å‡»</option>
                                        <option value="enemy-defense">æ•Œæ–¹é˜²å¾¡</option>
                                        <option value="enemy-speed">æ•Œæ–¹é€Ÿåº¦</option>
                                        <option value="enemy-hp">æ•Œæ–¹ç”Ÿå‘½</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">ä¼¤å®³ç™¾åˆ†æ¯”</label>
                                    <input type="number" id="param-damage-percent" step="0.01" min="0" value="0.1"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- é˜²å¾¡åŠ æˆå‚æ•° -->
                        <div id="param-defense-bonus-group" class="param-group">
                            <label class="block text-xs font-medium text-gray-400 mb-1">é˜²å¾¡åŠ æˆ</label>
                            <input type="number" id="param-defense-bonus" step="0.01" min="0" value="1.0"
                                class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                            <p class="text-xs text-gray-500 mt-1">ä¼¤å®³æŠµæŠ— = è‡ªèº«é˜²å¾¡åŠ› Ã— é˜²å¾¡åŠ æˆ</p>
                        </div>

                        <!-- åå‡»å‚æ•° -->
                        <div id="param-counter-group" class="param-group">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">åå‡»æ¥æº</label>
                                    <select id="param-counter-source"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="self-attack">æˆ‘æ–¹æ”»å‡»</option>
                                        <option value="self-defense">æˆ‘æ–¹é˜²å¾¡</option>
                                        <option value="enemy-attack">æ•Œæ–¹æ”»å‡»</option>
                                        <option value="enemy-defense">æ•Œæ–¹é˜²å¾¡</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">åå‡»åŠ æˆ</label>
                                    <input type="number" id="param-counter-bonus" step="0.01" min="0" value="0.5"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- å¢é€Ÿå‚æ•° -->
                        <div id="param-speed-bonus-group" class="param-group">
                            <label class="block text-xs font-medium text-gray-400 mb-1">å¢é€ŸåŠ æˆ</label>
                            <input type="number" id="param-speed-bonus" step="0.01" min="0" value="0.2"
                                class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                            <p class="text-xs text-gray-500 mt-1">é¢å¤–é€Ÿåº¦ = åŸºç¡€é€Ÿåº¦ Ã— å¢é€ŸåŠ æˆ</p>
                        </div>

                        <!-- é€šç”¨Buff/Debuffå‚æ•°æ¨¡æ¿ç”Ÿæˆå™¨ -->
                        <script>
                            function createBuffDebuffParams(id, title, color, defaultTarget = 'self', defaultSource = 'fixed') {
                                const isDebuff = id.startsWith('debuff');
                                const targetOptions = isDebuff ?
                                    '<option value="enemy-single">æ•Œæ–¹å•ä½“</option><option value="enemy-all">æ•Œæ–¹å…¨ä½“</option>' :
                                    '<option value="self">è‡ªèº«</option><option value="ally-single">æˆ‘æ–¹å•ä½“</option><option value="ally-all">æˆ‘æ–¹å…¨ä½“</option>';
                                
                                return `
                                <div id="param-${id}-group" class="param-group">
                                    <h4 class="text-sm font-semibold text-${color}-300 border-b border-${color}-800 pb-1 mb-2">${title}å‚æ•°</h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-400 mb-1">ç›®æ ‡</label>
                                            <select id="param-${id}-target" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm">
                                                ${targetOptions}
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-400 mb-1">æ¥æº</label>
                                            <select id="param-${id}-source" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm">
                                                <option value="self-attack">è‡ªèº«æ”»å‡»</option>
                                                <option value="self-defense">è‡ªèº«é˜²å¾¡</option>
                                                <option value="self-speed">è‡ªèº«é€Ÿåº¦</option>
                                                <option value="fixed" selected>å›ºå®šå€¼</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-400 mb-1">åŠ æˆå€¼</label>
                                            <input type="number" id="param-${id}-bonus" step="0.01" min="0" value="0.2" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm">
                                        </div>
                                    </div>
                                </div>`;
                            }

                            const buffParams = [
                                { id: 'buff_attack', title: 'å¢æ”»', color: 'purple' },
                                { id: 'buff_defense', title: 'å¢é˜²', color: 'purple' },
                                { id: 'buff_speed', title: 'å¢é€Ÿ', color: 'purple' },
                                { id: 'buff_heal_amp', title: 'æ²»ç–—å¢å¼º', color: 'purple' },
                                { id: 'debuff_attack', title: 'å‡æ”»', color: 'red' },
                                { id: 'debuff_defense', title: 'å‡é˜²', color: 'red' },
                                { id: 'debuff_speed', title: 'å‡é€Ÿ', color: 'red' },
                                { id: 'debuff_heal_reduce', title: 'å‡ç–—', color: 'red' }
                            ];

                            document.write(buffParams.map(p => createBuffDebuffParams(p.id, p.title, p.color)).join(''));
                        </script>

                        <!-- å¼‚å¸¸çŠ¶æ€å‚æ•° -->
                        <div id="param-status-group" class="param-group">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">å¼‚å¸¸çŠ¶æ€</label>
                                    <select id="param-status-type"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="stun">çœ©æ™•</option>
                                        <option value="poison">ä¸­æ¯’</option>
                                        <option value="bleed">æµè¡€</option>
                                        <option value="frostbite">å†»ä¼¤</option>
                                        <option value="burn">çƒ§ä¼¤</option>
                                        <option value="paralyze">éº»ç—¹</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ–½åŠ æ¦‚ç‡(%)</label>
                                    <input type="number" id="param-status-chance" min="0" max="100" value="50"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- å±æ€§å¢å‡ä¼¤å‚æ•° -->
                        <div id="param-element-group" class="param-group">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">é’ˆå¯¹å±æ€§</label>
                                    <select id="param-element-type"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="water">æ°´</option>
                                        <option value="fire">ç«</option>
                                        <option value="grass">è‰</option>
                                        <option value="wind">é£</option>
                                        <option value="electric">ç”µ</option>
                                        <option value="earth">åœŸ</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">å¢å‡ä¼¤åŠ æˆ</label>
                                    <input type="number" id="param-element-bonus" step="0.01" value="0.2"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- æ²»ç–—å‚æ•° -->
                        <div id="param-heal-group" class="param-group">
                            <div class="grid grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ¢å¤ç›®æ ‡</label>
                                    <select id="param-heal-target"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="self">è‡ªèº«</option>
                                        <option value="ally-single">æˆ‘æ–¹å•ä½“</option>
                                        <option value="ally-all">æˆ‘æ–¹å…¨ä½“</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ²»ç–—æ¥æº</label>
                                    <select id="param-heal-source"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="self-attack">è‡ªèº«æ”»å‡»</option>
                                        <option value="self-defense">è‡ªèº«é˜²å¾¡</option>
                                        <option value="self-hp">è‡ªèº«ç”Ÿå‘½</option>
                                        <option value="fixed">å›ºå®šå€¼</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ²»ç–—åŠ æˆ</label>
                                    <input type="number" id="param-heal-bonus" step="0.01" min="0" value="0.5"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- ç™¾åˆ†æ¯”æ¢å¤å‚æ•° -->
                        <div id="param-heal-percent-group" class="param-group">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ¢å¤æ¥æº</label>
                                    <select id="param-heal-percent-source"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="self-max-hp">è‡ªèº«æœ€å¤§ç”Ÿå‘½</option>
                                        <option value="self-current-hp">è‡ªèº«å½“å‰ç”Ÿå‘½</option>
                                        <option value="target-max-hp">ç›®æ ‡æœ€å¤§ç”Ÿå‘½</option>
                                        <option value="target-current-hp">ç›®æ ‡å½“å‰ç”Ÿå‘½</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ¢å¤ç™¾åˆ†æ¯”</label>
                                    <input type="number" id="param-heal-percent" step="0.01" min="0" max="1" value="0.3"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- é‡ç”Ÿå‚æ•° -->
                        <div id="param-rebirth-group" class="param-group">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">é‡ç”Ÿç›®æ ‡</label>
                                    <select id="param-rebirth-target"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="self">è‡ªèº«</option>
                                        <option value="ally-single">æˆ‘æ–¹å•ä½“</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">å¤æ´»ç”Ÿå‘½æ¯”ä¾‹</label>
                                    <input type="number" id="param-rebirth-percent" step="0.01" min="0" max="1" value="0.5"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- ç”Ÿå‘½æ±²å–å‚æ•° -->
                        <div id="param-lifesteal-group" class="param-group">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ±²å–æ¥æº</label>
                                    <select id="param-lifesteal-source"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                        <option value="self-attack">æˆ‘æ–¹æ”»å‡»</option>
                                        <option value="self-defense">æˆ‘æ–¹é˜²å¾¡</option>
                                        <option value="enemy-attack">æ•Œæ–¹æ”»å‡»</option>
                                        <option value="enemy-hp">æ•Œæ–¹ç”Ÿå‘½</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">æ±²å–åŠ æˆ</label>
                                    <input type="number" id="param-lifesteal-bonus" step="0.01" min="0" value="0.2"
                                        class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500">
                                </div>
                            </div>
                        </div>
                        
                    </div>

                    <!-- æŒ‰é’® -->
                    <div class="flex gap-4 pt-4">
                        <button type="submit" id="submit-btn"
                            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            <span id="submit-text">âœ¨ åˆ›å»ºæŠ€èƒ½</span>
                        </button>
                        <button type="button" id="cancel-edit-btn" class="hidden bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            âŒ å–æ¶ˆç¼–è¾‘
                        </button>
                        <button type="button" id="clear-btn"
                            class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            ğŸ”„ æ¸…ç©º
                        </button>
                    </div>
                </form>
            </div>

            <!-- å³ä¾§ï¼šæŠ€èƒ½é¢„è§ˆå’Œåˆ—è¡¨ -->
            <div class="space-y-6">
                <!-- æŠ€èƒ½é¢„è§ˆ -->
                <div class="bg-gray-900/80 backdrop-blur-lg rounded-xl p-6 border border-gray-700">
                    <h3 class="text-xl font-bold text-white mb-4">ğŸ‘ï¸ æŠ€èƒ½é¢„è§ˆ</h3>
                    <div id="skill-preview" class="skill-card bg-gray-800 rounded-lg p-4 border-2 border-gray-600">
                        <div class="text-center text-gray-500">
                            <div class="text-4xl mb-2">â“</div>
                            <div class="text-sm">å¡«å†™è¡¨å•æŸ¥çœ‹é¢„è§ˆ</div>
                        </div>
                    </div>
                </div>

                <!-- å·²åˆ›å»ºæŠ€èƒ½åˆ—è¡¨ -->
                <div class="bg-gray-900/80 backdrop-blur-lg rounded-xl p-6 border border-gray-700">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-white">ğŸ“‹ æŠ€èƒ½åˆ—è¡¨ (<span id="skill-count">0</span>)</h3>
                        <div class="flex gap-2">
                            <label for="import-file"
                                class="bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold py-2 px-4 rounded-lg transition-colors cursor-pointer">
                                ğŸ“¤ å¯¼å…¥
                            </label>
                            <input type="file" id="import-file" accept=".json" class="hidden">
                            <button id="export-btn"
                                class="bg-green-600 hover:bg-green-700 text-white text-sm font-bold py-2 px-4 rounded-lg transition-colors">
                                ğŸ“¥ å¯¼å‡º
                            </button>
                        </div>
                    </div>
                    <div id="skills-list" class="space-y-3 max-h-96 overflow-y-auto">
                        <div class="text-center text-gray-500 text-sm py-8">
                            æš‚æ— æŠ€èƒ½
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Emojié€‰æ‹©å™¨æ¨¡æ€æ¡† -->
        <div id="emoji-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <div class="bg-gray-900 rounded-xl p-6 max-w-md w-full mx-4 border border-gray-700">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-white">é€‰æ‹©å›¾æ ‡</h3>
                    <button id="close-emoji-modal" class="text-gray-400 hover:text-white text-2xl">Ã—</button>
                </div>
                <div id="emoji-grid" class="emoji-picker bg-gray-800 rounded-lg p-4">
                    <!-- Emojiåˆ—è¡¨ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¸¸ç”¨Emojiåˆ—è¡¨
        const EMOJIS = [
            'âš”ï¸', 'ğŸ—¡ï¸', 'ğŸ”ª', 'ğŸ¹', 'ğŸ”«', 'ğŸ’£', 'ğŸ§¨', 'ğŸ’¥',
            'ğŸ›¡ï¸', 'ğŸ°', 'ğŸ§±', 'â›“ï¸', 'ğŸ”’', 'ğŸ”', 'ğŸ—ï¸', 'ğŸ”‘',
            'âš¡', 'ğŸ”¥', 'ğŸ’§', 'ğŸŒŠ', 'ğŸŒ¿', 'ğŸƒ', 'ğŸ’¨', 'ğŸŒªï¸',
            'â„ï¸', 'â˜ƒï¸', 'ğŸ§Š', 'ğŸ’', 'ğŸ’ ', 'ğŸ”®', 'ğŸŒŸ', 'âœ¨',
            'ğŸ’«', 'â­', 'ğŸŒ™', 'â˜€ï¸', 'ğŸŒˆ', 'â˜ï¸', 'â›ˆï¸', 'ğŸŒ©ï¸',
            'ğŸ’ª', 'ğŸ‘Š', 'âœŠ', 'ğŸ¤œ', 'ğŸ¤›', 'ğŸ‘‹', 'ğŸ–ï¸', 'âœ‹',
            'ğŸ’š', 'ğŸ’™', 'ğŸ’œ', 'ğŸ–¤', 'ğŸ¤', 'â¤ï¸', 'ğŸ§¡', 'ğŸ’›',
            'ğŸ©¸', 'ğŸ’‰', 'ğŸ’Š', 'ğŸ§ª', 'ğŸ§¬', 'ğŸ”¬', 'ğŸ§²', 'âš—ï¸',
            'ğŸ¯', 'ğŸ²', 'ğŸ°', 'ğŸ®', 'ğŸ•¹ï¸', 'ğŸª', 'ğŸ­', 'ğŸ¨',
            'ğŸŒ€', 'ğŸŒ‘', 'ğŸŒ’', 'ğŸŒ“', 'ğŸŒ”', 'ğŸŒ•', 'ğŸŒ–', 'ğŸŒ—',
            'ğŸ‘¤', 'ğŸ‘¥', 'ğŸ‘»', 'ğŸ’€', 'â˜ ï¸', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ¤–',
            'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ˜¡', 'ğŸ’¢', 'ğŸ’¯', 'ğŸ”±', 'âšœï¸', 'â™»ï¸'
        ];

        // æŠ€èƒ½æ•ˆæœå‚æ•°é…ç½®
        const EFFECT_PARAMS = {
            'direct_attack': ['attack-bonus'],
            'multi_attack': ['multi-bonus'],
            'dot_damage': ['attack-bonus'],
            'percent_damage': ['percent-damage'],
            'direct_defense': ['defense-bonus'],
            'continuous_defense': ['defense-bonus'],
            'defense_counter': ['defense-bonus', 'counter'],
            'direct_speed': ['speed-bonus'],
            'continuous_speed': ['speed-bonus'],
            'buff_attack': ['buff_attack'],
            'buff_defense': ['buff_defense'],
            'buff_speed': ['speed-bonus'],
            'buff_status_enemy': ['status'],
            'buff_purify': [],
            'buff_heal_amp': ['buff_attack'], // Example, can be customized
            'buff_element_damage': ['element'],
            'debuff_attack': ['debuff_attack'],
            'debuff_defense': ['debuff_defense'],
            'debuff_speed': ['speed-bonus'],
            'debuff_status_self': ['status'],
            'debuff_no_heal': [],
            'debuff_heal_reduce': ['buff'],
            'debuff_element_damage': ['element'],
            'heal_direct': ['heal'],
            'heal_continuous': ['heal'],
            'heal_percent': ['heal-percent'],
            'heal_rebirth': ['rebirth'],
            'heal_lifesteal': ['lifesteal']
        };

        // æŠ€èƒ½æ± å­˜å‚¨
        let skills = JSON.parse(localStorage.getItem('SKILL_POOL') || '[]');
        let editingIndex = -1;

        // DOMå…ƒç´ 
        const form = document.getElementById('skill-form');
        const preview = document.getElementById('skill-preview');
        const skillsList = document.getElementById('skills-list');
        const skillCount = document.getElementById('skill-count');
        const emojiModal = document.getElementById('emoji-modal');
        const emojiGrid = document.getElementById('emoji-grid');

        // åˆå§‹åŒ–
        function init() {
            renderSkillsList();
            setupEmojiPicker();
            setupFormListeners();
            updateSkillCount();
        }

        // æ›´æ–°æŠ€èƒ½æ•°é‡
        function updateSkillCount() {
            skillCount.textContent = skills.length;
        }

        // è®¾ç½®Emojié€‰æ‹©å™¨
        function setupEmojiPicker() {
            emojiGrid.innerHTML = '';
            EMOJIS.forEach(emoji => {
                const btn = document.createElement('button');
                btn.className = 'emoji-btn';
                btn.textContent = emoji;
                btn.type = 'button';
                btn.onclick = () => {
                    document.getElementById('skill-icon').value = emoji;
                    emojiModal.classList.add('hidden');
                    updatePreview();
                };
                emojiGrid.appendChild(btn);
            });

            document.getElementById('emoji-picker-btn').onclick = () => emojiModal.classList.remove('hidden');
            document.getElementById('close-emoji-modal').onclick = () => emojiModal.classList.add('hidden');
            emojiModal.onclick = (e) => {
                if (e.target === emojiModal) emojiModal.classList.add('hidden');
            };
        }

        // è®¾ç½®è¡¨å•ç›‘å¬å™¨
        function setupFormListeners() {
            // å®æ—¶é¢„è§ˆ
            form.querySelectorAll('input, select, textarea').forEach(input => {
                input.addEventListener('input', updatePreview);
            });

            // æŠ€èƒ½ç±»å‹å’Œæ•ˆæœå¤é€‰æ¡†æ”¹å˜æ—¶æ˜¾ç¤ºå¯¹åº”å‚æ•°å’Œæ›´æ–°é¢„è§ˆ
            document.querySelectorAll('.skill-type-checkbox, .skill-effect-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    showRelevantParams();
                    updatePreview();
                });
            });

            // æäº¤è¡¨å•
            form.onsubmit = (e) => {
                e.preventDefault();
                if (editingIndex >= 0) {
                    updateSkill();
                } else {
                    createSkill();
                }
            };

            // æ¸…ç©ºæŒ‰é’®
            document.getElementById('clear-btn').onclick = () => {
                form.reset();
                cancelEdit();
                showRelevantParams();
                updatePreview();
            };

            // å–æ¶ˆç¼–è¾‘æŒ‰é’®
            document.getElementById('cancel-edit-btn').onclick = () => {
                form.reset();
                cancelEdit();
                showRelevantParams();
                updatePreview();
            };

            // å¯¼å‡ºæŒ‰é’®
            document.getElementById('export-btn').onclick = exportSkills;

            // å¯¼å…¥æŒ‰é’®
            document.getElementById('import-file').onchange = importSkills;
        }

        // æ˜¾ç¤ºç›¸å…³å‚æ•°
        function showRelevantParams() {
            // è·å–æ‰€æœ‰é€‰ä¸­çš„æ•ˆæœ
            const selectedEffects = Array.from(document.querySelectorAll('.skill-effect-checkbox:checked'))
                .map(checkbox => checkbox.value);
            
            // æ”¶é›†æ‰€æœ‰é€‰ä¸­æ•ˆæœéœ€è¦çš„å‚æ•°
            const allParams = new Set();
            selectedEffects.forEach(effect => {
                const params = EFFECT_PARAMS[effect] || [];
                params.forEach(param => allParams.add(param));
            });

            // éšè—æ‰€æœ‰å‚æ•°ç»„
            document.querySelectorAll('.param-group').forEach(group => {
                group.classList.remove('active');
            });

            // æ˜¾ç¤ºç›¸å…³å‚æ•°ç»„
            allParams.forEach(param => {
                const group = document.getElementById(`param-${param}-group`);
                if (group) group.classList.add('active');
            });
        }

        // æ›´æ–°é¢„è§ˆ
        function updatePreview() {
            const data = getFormData();
            if (!data.name) {
                preview.innerHTML = `
                    <div class="text-center text-gray-500">
                        <div class="text-4xl mb-2">â“</div>
                        <div class="text-sm">å¡«å†™è¡¨å•æŸ¥çœ‹é¢„è§ˆ</div>
                    </div>
                `;
                return;
            }

            const categoryClass = data.category || 'bg-gray-700';
            const typeIcons = {
                'attack': 'âš”ï¸',
                'defense': 'ğŸ›¡ï¸',
                'agility': 'âš¡',
                'buff': 'ğŸ’ª',
                'debuff': 'ğŸ”»',
                'heal': 'ğŸ’š'
            };
            
            // ç”Ÿæˆç±»å‹æ ‡ç­¾ï¼ˆæ”¯æŒå¤šä¸ªç±»å‹ï¼‰
            const typeLabels = data.types && data.types.length > 0 ? data.types.map(type =>
                `<span class="bg-blue-600/30 text-blue-300 px-2 py-1 rounded text-xs font-bold">${typeIcons[type]} ${getTypeName(type)}</span>`
            ).join('') : '';
            
            // ç”Ÿæˆæ•ˆæœæ ‡ç­¾ï¼ˆæ”¯æŒå¤šä¸ªæ•ˆæœï¼‰
            const effectLabels = data.effects && data.effects.length > 0 ? data.effects.map(effect =>
                `<span class="bg-green-600/30 text-green-300 px-2 py-1 rounded text-xs">${getEffectName(effect)}</span>`
            ).join('') : '';
            
            // ç”Ÿæˆå‚æ•°æè¿°
            let paramDesc = [];
            if (data.params.cooldown > 0) paramDesc.push(`CD:${data.params.cooldown}å›åˆ`);
            if (data.params.duration > 0) paramDesc.push(`æŒç»­:${data.params.duration}å›åˆ`);
            if (data.params.count > 1) paramDesc.push(`${data.params.count}æ¬¡`);
            
            preview.innerHTML = `
                <div class="flex items-start gap-3">
                    <div class="text-4xl">${data.icon || 'â“'}</div>
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2 flex-wrap">
                            <h4 class="text-lg font-bold text-white">${data.name}</h4>
                            <span class="category-badge ${categoryClass}">${getCategoryName(data.category)}</span>
                            ${data.rarity ? `<span class="category-badge rarity-${data.rarity}">${getRarityName(data.rarity)}</span>` : ''}
                        </div>
                        ${typeLabels ? `<div class="flex flex-wrap gap-1 mb-2">${typeLabels}</div>` : ''}
                        ${data.description ? `<p class="text-xs text-gray-400 italic mb-2">${data.description}</p>` : ''}
                        ${effectLabels ? `<div class="flex flex-wrap gap-1 mb-2">${effectLabels}</div>` : ''}
                        ${paramDesc.length > 0 ? `<div class="flex flex-wrap gap-2 text-xs">
                            ${paramDesc.map(p => `<span class="bg-purple-600/30 text-purple-300 px-2 py-1 rounded">${p}</span>`).join('')}
                        </div>` : ''}
                    </div>
                </div>
            `;
        }

        // è·å–æ•ˆæœæè¿°
        function getEffectDescription(data) {
            const effect = data.effect;
            const params = data.params;
            
            // å¦‚æœæœ‰è‡ªå®šä¹‰æè¿°ï¼Œä¼˜å…ˆä½¿ç”¨
            if (data.description) {
                return data.description;
            }
            
            const descriptions = {
                'direct_attack': `é€ æˆ ${params.attackBonus || 1}Ã— æ”»å‡»åŠ›çš„ä¼¤å®³`,
                'multi_attack': `è¿›è¡Œ ${params.count} æ®µæ”»å‡»`,
                'dot_damage': `æ¯å›åˆé€ æˆ ${params.attackBonus || 1}Ã— æ”»å‡»åŠ›çš„æŒç»­ä¼¤å®³`,
                'percent_damage': `é€ æˆç›®æ ‡ ${(params.damagePercent || 0.1) * 100}% ${params.damageSource || 'ç”Ÿå‘½'} çš„ä¼¤å®³`,
                'direct_defense': `æŠµæŒ¡ ${params.defenseBonus || 1}Ã— é˜²å¾¡åŠ›çš„ä¼¤å®³`,
                'continuous_defense': `æŒç»­æŠµæŒ¡ ${params.defenseBonus || 1}Ã— é˜²å¾¡åŠ›çš„ä¼¤å®³`,
                'defense_counter': `é˜²å¾¡å¹¶åå‡» ${params.counterBonus || 0.5}Ã— ä¼¤å®³`,
                'direct_speed': `å¢åŠ  ${(params.speedBonus || 0.2) * 100}% é€Ÿåº¦`,
                'continuous_speed': `æŒç»­å¢åŠ  ${(params.speedBonus || 0.2) * 100}% é€Ÿåº¦`,
                'buff_attack': `å¢åŠ  ${(params.buffBonus || 0.2) * 100}% æ”»å‡»åŠ›`,
                'buff_defense': `å¢åŠ  ${(params.buffBonus || 0.2) * 100}% é˜²å¾¡åŠ›`,
                'buff_speed': `å¢åŠ  ${(params.speedBonus || 0.2) * 100}% é€Ÿåº¦`,
                'buff_status_enemy': `æœ‰ ${params.statusChance || 50}% æ¦‚ç‡å¯¹æ•Œæ–¹æ–½åŠ  ${getStatusName(params.statusType)}`,
                'buff_purify': `å‡€åŒ–æ‰€æœ‰å¼‚å¸¸çŠ¶æ€`,
                'buff_heal_amp': `å¢åŠ  ${(params.buffBonus || 0.2) * 100}% æ²»ç–—æ•ˆæœ`,
                'buff_element_damage': `å¢åŠ  ${(params.elementBonus || 0.2) * 100}% ${params.elementType || 'å±æ€§'} ç³»ä¼¤å®³`,
                'debuff_attack': `é™ä½æ•Œæ–¹ ${(params.buffBonus || 0.2) * 100}% æ”»å‡»åŠ›`,
                'debuff_defense': `é™ä½æ•Œæ–¹ ${(params.buffBonus || 0.2) * 100}% é˜²å¾¡åŠ›`,
                'debuff_speed': `é™ä½æ•Œæ–¹ ${(params.speedBonus || 0.2) * 100}% é€Ÿåº¦`,
                'debuff_status_self': `ä¸ºè‡ªèº«æ–½åŠ  ${getStatusName(params.statusType)}`,
                'debuff_no_heal': `ç¦æ­¢ç›®æ ‡æ¢å¤ç”Ÿå‘½`,
                'debuff_heal_reduce': `é™ä½ç›®æ ‡ ${(params.buffBonus || 0.2) * 100}% æ²»ç–—æ•ˆæœ`,
                'debuff_element_damage': `é™ä½ ${(params.elementBonus || 0.2) * 100}% ${params.elementType || 'å±æ€§'} ç³»ä¼¤å®³`,
                'heal_direct': `æ¢å¤ ${params.healBonus || 0.5}Ã— ${params.healSource || 'æ”»å‡»åŠ›'} çš„ç”Ÿå‘½`,
                'heal_continuous': `æ¯å›åˆæ¢å¤ ${params.healBonus || 0.5}Ã— ${params.healSource || 'æ”»å‡»åŠ›'} çš„ç”Ÿå‘½`,
                'heal_percent': `æ¢å¤ ${(params.healPercent || 0.3) * 100}% ${params.healPercentSource || 'æœ€å¤§ç”Ÿå‘½'}`,
                'heal_rebirth': `å¤æ´»å¹¶æ¢å¤ ${(params.rebirthPercent || 0.5) * 100}% ç”Ÿå‘½`,
                'heal_lifesteal': `æ±²å– ${(params.lifestealBonus || 0.2) * 100}% ä¼¤å®³è½¬åŒ–ä¸ºç”Ÿå‘½`
            };
            
            return descriptions[effect] || getEffectName(effect);
        }

        // è·å–è¡¨å•æ•°æ®
        function getFormData() {
            // è·å–é€‰ä¸­çš„ç±»å‹ï¼ˆå¤šé€‰ï¼‰
            const selectedTypes = Array.from(document.querySelectorAll('.skill-type-checkbox:checked'))
                .map(checkbox => checkbox.value);
            
            // è·å–é€‰ä¸­çš„æ•ˆæœï¼ˆå¤šé€‰ï¼‰
            const selectedEffects = Array.from(document.querySelectorAll('.skill-effect-checkbox:checked'))
                .map(checkbox => checkbox.value);
            
            const params = {
                cooldown: parseInt(document.getElementById('param-cooldown').value) || 0,
                duration: parseInt(document.getElementById('param-duration').value) || 0,
                count: parseInt(document.getElementById('param-count').value) || 1
            };

            // æ ¹æ®æ‰€æœ‰é€‰ä¸­çš„æ•ˆæœç±»å‹æ”¶é›†ç›¸å…³å‚æ•°
            const allEffectParams = new Set();
            selectedEffects.forEach(effect => {
                const effectParams = EFFECT_PARAMS[effect] || [];
                effectParams.forEach(param => allEffectParams.add(param));
            });
            
            if (allEffectParams.has('attack-bonus')) {
                params.attackBonus = parseFloat(document.getElementById('param-attack-bonus').value) || 1.0;
            }
            
            if (allEffectParams.has('multi-bonus')) {
                const multiBonusStr = document.getElementById('param-multi-bonus').value;
                params.multiBonus = multiBonusStr ? multiBonusStr.split(',').map(v => parseFloat(v.trim())) : [1.0];
            }
            
            if (allEffectParams.has('percent-damage')) {
                params.damageSource = document.getElementById('param-damage-source').value;
                params.damagePercent = parseFloat(document.getElementById('param-damage-percent').value) || 0.1;
            }
            
            if (allEffectParams.has('defense-bonus')) {
                params.defenseBonus = parseFloat(document.getElementById('param-defense-bonus').value) || 1.0;
            }
            
            if (allEffectParams.has('counter')) {
                params.counterSource = document.getElementById('param-counter-source').value;
                params.counterBonus = parseFloat(document.getElementById('param-counter-bonus').value) || 0.5;
            }
            
            if (allEffectParams.has('speed-bonus')) {
                params.speedBonus = parseFloat(document.getElementById('param-speed-bonus').value) || 0.2;
            }
            
            // Helper to collect data for a specific buff/debuff
            const collectBuffDebuffParams = (effect) => {
                if (allEffectParams.has(effect)) {
                    params[effect] = {
                        target: document.getElementById(`param-${effect}-target`).value,
                        source: document.getElementById(`param-${effect}-source`).value,
                        bonus: parseFloat(document.getElementById(`param-${effect}-bonus`).value) || 0.2,
                    };
                }
            };
            
            const buffDebuffList = [
                'buff_attack', 'buff_defense', 'buff_speed', 'buff_heal_amp',
                'debuff_attack', 'debuff_defense', 'debuff_speed', 'debuff_heal_reduce'
            ];
            
            buffDebuffList.forEach(effect => collectBuffDebuffParams(effect));
            
            if (allEffectParams.has('status')) {
                params.statusType = document.getElementById('param-status-type').value;
                params.statusChance = parseInt(document.getElementById('param-status-chance').value) || 50;
                
                // å åŠ å±‚æ•°ç›¸å…³å‚æ•°
                const isStackable = document.getElementById('param-status-stackable').checked;
                if (isStackable) {
                    params.statusStackable = true;
                    params.statusMaxStacks = parseInt(document.getElementById('param-status-max-stacks').value) || 1;
                    params.statusStackBonus = parseFloat(document.getElementById('param-status-stack-bonus').value) || 0.1;
                }
            }
            
            if (allEffectParams.has('element')) {
                params.elementType = document.getElementById('param-element-type').value;
                params.elementBonus = parseFloat(document.getElementById('param-element-bonus').value) || 0.2;
            }
            
            if (allEffectParams.has('heal')) {
                params.healTarget = document.getElementById('param-heal-target').value;
                params.healSource = document.getElementById('param-heal-source').value;
                params.healBonus = parseFloat(document.getElementById('param-heal-bonus').value) || 0.5;
            }
            
            if (allEffectParams.has('heal-percent')) {
                params.healPercentSource = document.getElementById('param-heal-percent-source').value;
                params.healPercent = parseFloat(document.getElementById('param-heal-percent').value) || 0.3;
            }
            
            if (allEffectParams.has('rebirth')) {
                params.rebirthTarget = document.getElementById('param-rebirth-target').value;
                params.rebirthPercent = parseFloat(document.getElementById('param-rebirth-percent').value) || 0.5;
            }
            
            if (allEffectParams.has('lifesteal')) {
                params.lifestealSource = document.getElementById('param-lifesteal-source').value;
                params.lifestealBonus = parseFloat(document.getElementById('param-lifesteal-bonus').value) || 0.2;
            }

            const data = {
                name: document.getElementById('skill-name').value,
                icon: document.getElementById('skill-icon').value,
                description: document.getElementById('skill-description').value,
                category: document.getElementById('skill-category').value,
                types: selectedTypes,
                effects: selectedEffects,
                params: params
            };
            
            // æ·»åŠ ç¨€æœ‰åº¦ï¼ˆå¦‚æœé€‰æ‹©äº†ï¼‰
            const rarity = document.getElementById('skill-rarity').value;
            if (rarity) {
                data.rarity = rarity;
            }
            
            return data;
        }

        // åˆ›å»ºæŠ€èƒ½
        function createSkill() {
            const data = getFormData();
            const skillKey = `CUSTOM_${Date.now()}`;
            
            const skill = {
                key: skillKey,
                ...data,
                createdAt: new Date().toISOString()
            };

            skills.push(skill);
            saveSkillPool();
            
            renderSkillsList();
            updateSkillCount();
            form.reset();
            showRelevantParams();
            updatePreview();
            
            alert(`âœ… æŠ€èƒ½ "${data.name}" å·²åˆ›å»ºï¼`);
        }

        // æ›´æ–°æŠ€èƒ½
        function updateSkill() {
            const data = getFormData();
            
            const skill = {
                key: skills[editingIndex].key,
                ...data,
                createdAt: skills[editingIndex].createdAt,
                updatedAt: new Date().toISOString()
            };

            skills[editingIndex] = skill;
            saveSkillPool();
            
            renderSkillsList();
            form.reset();
            cancelEdit();
            showRelevantParams();
            updatePreview();
            
            alert(`âœ… æŠ€èƒ½ "${data.name}" å·²æ›´æ–°ï¼`);
        }

        // ç¼–è¾‘æŠ€èƒ½
        function editSkill(index) {
            editingIndex = index;
            const skill = skills[index];
            
            // å¡«å……è¡¨å•
            document.getElementById('skill-name').value = skill.name;
            document.getElementById('skill-icon').value = skill.icon;
            document.getElementById('skill-description').value = skill.description || '';
            document.getElementById('skill-category').value = skill.category;
            document.getElementById('skill-rarity').value = skill.rarity || '';
            
            // æ¸…é™¤æ‰€æœ‰å¤é€‰æ¡†
            document.querySelectorAll('.skill-type-checkbox').forEach(cb => cb.checked = false);
            document.querySelectorAll('.skill-effect-checkbox').forEach(cb => cb.checked = false);
            
            // å¡«å……ç±»å‹ï¼ˆå…¼å®¹æ—§æ ¼å¼å’Œæ–°æ ¼å¼ï¼‰
            const types = skill.types || (skill.type ? [skill.type] : []);
            types.forEach(type => {
                const checkbox = document.querySelector(`.skill-type-checkbox[value="${type}"]`);
                if (checkbox) checkbox.checked = true;
            });
            
            // å¡«å……æ•ˆæœï¼ˆå…¼å®¹æ—§æ ¼å¼å’Œæ–°æ ¼å¼ï¼‰
            const effects = skill.effects || (skill.effect ? [skill.effect] : []);
            effects.forEach(effect => {
                const checkbox = document.querySelector(`.skill-effect-checkbox[value="${effect}"]`);
                if (checkbox) checkbox.checked = true;
            });
            
            // å¡«å……å‚æ•°
            const params = skill.params || {};
            document.getElementById('param-cooldown').value = params.cooldown || 0;
            document.getElementById('param-duration').value = params.duration || 0;
            document.getElementById('param-count').value = params.count || 1;
            
            if (params.attackBonus !== undefined) {
                document.getElementById('param-attack-bonus').value = params.attackBonus;
            }
            if (params.multiBonus) {
                document.getElementById('param-multi-bonus').value = params.multiBonus.join(',');
            }
            if (params.damageSource) {
                document.getElementById('param-damage-source').value = params.damageSource;
                document.getElementById('param-damage-percent').value = params.damagePercent || 0.1;
            }
            if (params.defenseBonus !== undefined) {
                document.getElementById('param-defense-bonus').value = params.defenseBonus;
            }
            if (params.counterSource) {
                document.getElementById('param-counter-source').value = params.counterSource;
                document.getElementById('param-counter-bonus').value = params.counterBonus || 0.5;
            }
            if (params.speedBonus !== undefined) {
                document.getElementById('param-speed-bonus').value = params.speedBonus;
            }
            // Helper to fill data for a specific buff/debuff
            const fillBuffDebuffParams = (effect) => {
                if (params[effect]) {
                    document.getElementById(`param-${effect}-target`).value = params[effect].target || '';
                    document.getElementById(`param-${effect}-source`).value = params[effect].source || '';
                    document.getElementById(`param-${effect}-bonus`).value = params[effect].bonus || 0.2;
                }
            };

            const buffDebuffList = [
                'buff_attack', 'buff_defense', 'buff_speed', 'buff_heal_amp',
                'debuff_attack', 'debuff_defense', 'debuff_speed', 'debuff_heal_reduce'
            ];
            
            buffDebuffList.forEach(effect => fillBuffDebuffParams(effect));
            if (params.statusType) {
                document.getElementById('param-status-type').value = params.statusType;
                document.getElementById('param-status-chance').value = params.statusChance || 50;
                
                // å åŠ å±‚æ•°ç›¸å…³
                if (params.statusStackable) {
                    document.getElementById('param-status-stackable').checked = true;
                    document.getElementById('param-status-max-stacks').disabled = false;
                    document.getElementById('param-status-stack-bonus').disabled = false;
                    document.getElementById('param-status-max-stacks').value = params.statusMaxStacks || 1;
                    document.getElementById('param-status-stack-bonus').value = params.statusStackBonus || 0.1;
                }
            }
            if (params.elementType) {
                document.getElementById('param-element-type').value = params.elementType;
                document.getElementById('param-element-bonus').value = params.elementBonus || 0.2;
            }
            if (params.healTarget) {
                document.getElementById('param-heal-target').value = params.healTarget;
                document.getElementById('param-heal-source').value = params.healSource || 'self-attack';
                document.getElementById('param-heal-bonus').value = params.healBonus || 0.5;
            }
            if (params.healPercentSource) {
                document.getElementById('param-heal-percent-source').value = params.healPercentSource;
                document.getElementById('param-heal-percent').value = params.healPercent || 0.3;
            }
            if (params.rebirthTarget) {
                document.getElementById('param-rebirth-target').value = params.rebirthTarget;
                document.getElementById('param-rebirth-percent').value = params.rebirthPercent || 0.5;
            }
            if (params.lifestealSource) {
                document.getElementById('param-lifesteal-source').value = params.lifestealSource;
                document.getElementById('param-lifesteal-bonus').value = params.lifestealBonus || 0.2;
            }
            
            // æ›´æ–°UI
            document.getElementById('submit-text').textContent = 'ğŸ’¾ ä¿å­˜ä¿®æ”¹';
            document.getElementById('submit-btn').classList.remove('bg-blue-600', 'hover:bg-blue-700');
            document.getElementById('submit-btn').classList.add('bg-green-600', 'hover:bg-green-700');
            document.getElementById('cancel-edit-btn').classList.remove('hidden');
            
            showRelevantParams();
            updatePreview();
            
            form.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // å–æ¶ˆç¼–è¾‘
        function cancelEdit() {
            editingIndex = -1;
            document.getElementById('submit-text').textContent = 'âœ¨ åˆ›å»ºæŠ€èƒ½';
            document.getElementById('submit-btn').classList.remove('bg-green-600', 'hover:bg-green-700');
            document.getElementById('submit-btn').classList.add('bg-blue-600', 'hover:bg-blue-700');
            document.getElementById('cancel-edit-btn').classList.add('hidden');
        }
        
        // ä¿å­˜æŠ€èƒ½æ± 
        function saveSkillPool() {
            localStorage.setItem('SKILL_POOL', JSON.stringify(skills));
        }

        // æ¸²æŸ“æŠ€èƒ½åˆ—è¡¨
        function renderSkillsList() {
            if (skills.length === 0) {
                skillsList.innerHTML = `
                    <div class="text-center text-gray-500 text-sm py-8">
                        æš‚æ— æŠ€èƒ½
                    </div>
                `;
                return;
            }

            const typeIcons = {
                'attack': 'âš”ï¸',
                'defense': 'ğŸ›¡ï¸',
                'agility': 'âš¡',
                'buff': 'ğŸ’ª',
                'debuff': 'ğŸ”»',
                'heal': 'ğŸ’š'
            };

            skillsList.innerHTML = skills.map((skill, index) => {
                // å…¼å®¹æ—§æ ¼å¼å’Œæ–°æ ¼å¼
                const types = skill.types || (skill.type ? [skill.type] : []);
                const effects = skill.effects || (skill.effect ? [skill.effect] : []);
                
                const typeLabels = types.map(type => {
                    const icon = typeIcons[type] || '';
                    const name = getTypeName(type);
                    return `<span class="bg-blue-600/30 text-blue-300 px-2 py-0.5 rounded text-xs">${icon} ${name}</span>`;
                }).join(' ');
                
                const effectLabels = effects.map(effect =>
                    `<span class="bg-green-600/30 text-green-300 px-1.5 py-0.5 rounded text-xs">${getEffectName(effect)}</span>`
                ).join(' ');
                
                return `
                    <div class="skill-card bg-gray-800 rounded-lg p-3 border border-gray-600">
                        <div class="flex items-start gap-2">
                            <div class="text-2xl">${skill.icon}</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2 mb-1 flex-wrap">
                                    <h5 class="text-sm font-bold text-white truncate">${skill.name}</h5>
                                    <span class="category-badge ${skill.category} text-xs">${getCategoryName(skill.category)}</span>
                                    ${skill.rarity ? `<span class="category-badge rarity-${skill.rarity} text-xs">${getRarityName(skill.rarity)}</span>` : ''}
                                </div>
                                ${skill.description ? `<p class="text-xs text-gray-500 italic mb-1">${skill.description}</p>` : ''}
                                ${typeLabels ? `<div class="mb-1">${typeLabels}</div>` : ''}
                                ${effectLabels ? `<div>${effectLabels}</div>` : ''}
                            </div>
                            <div class="flex gap-1 flex-shrink-0">
                                <button onclick="editSkill(${index})"
                                    class="text-blue-400 hover:text-blue-300 text-lg px-2"
                                    title="ç¼–è¾‘">
                                    âœï¸
                                </button>
                                <button onclick="deleteSkill(${index})"
                                    class="text-red-400 hover:text-red-300 text-xl"
                                    title="åˆ é™¤">
                                    Ã—
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // åˆ é™¤æŠ€èƒ½
        function deleteSkill(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæŠ€èƒ½å—ï¼Ÿ')) {
                skills.splice(index, 1);
                saveSkillPool();
                renderSkillsList();
                updateSkillCount();
            }
        }

        // å¯¼å‡ºæŠ€èƒ½æ± 
        function exportSkills() {
            if (skills.length === 0) {
                alert('æŠ€èƒ½æ± ä¸ºç©ºï¼');
                return;
            }

            const dataStr = JSON.stringify(skills, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `skill_pool_${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // å¯¼å…¥æŠ€èƒ½
        function importSkills(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                try {
                    const importedSkills = JSON.parse(event.target.result);
                    
                    if (!Array.isArray(importedSkills)) {
                        alert('âŒ æ— æ•ˆçš„JSONæ ¼å¼ï¼');
                        return;
                    }

                    const existingKeys = new Set(skills.map(s => s.key));
                    const newSkills = importedSkills.filter(s => !existingKeys.has(s.key));
                    
                    skills = [...skills, ...newSkills];
                    saveSkillPool();
                    
                    renderSkillsList();
                    updateSkillCount();
                    alert(`âœ… æˆåŠŸå¯¼å…¥ ${newSkills.length} ä¸ªæ–°æŠ€èƒ½ï¼`);
                } catch (error) {
                    alert('âŒ å¯¼å…¥å¤±è´¥ï¼š' + error.message);
                }
            };
            reader.readAsText(file);
            
            e.target.value = '';
        }

        // è¾…åŠ©å‡½æ•°
        function getCategoryName(category) {
            const names = {
                'element-water': 'æ°´ç³»',
                'element-fire': 'ç«ç³»',
                'element-grass': 'è‰ç³»',
                'element-wind': 'é£ç³»',
                'element-electric': 'ç”µç³»',
                'element-earth': 'åœŸç³»',
                'mutation-dark': 'ğŸ–¤ é»‘åŒ–',
                'mutation-light': 'ğŸ¤ ç™½åŒ–',
                'mutation-crystal': 'ğŸ’ æ™¶åŒ–',
                'mutation-shadow': 'ğŸ‘¤ å½±åŒ–',
                'mutation-chaos': 'ğŸŒ‘ æš—èš€',
                'mutation-holy': 'âœ¨ åœ£è¾‰',
                'mutation-psychic': 'ğŸ”® å¼‚èƒ½',
                'mutation-thunder': 'âš¡ æç”µ',
                'mutation-eternal-dark': 'ğŸŒ™ æ°¸å¤œ',
                'mutation-eternal-light': 'â˜€ï¸ æ°¸è€€',
                'mutation-source-crystal': 'ğŸ’  æºæ™¶',
                'mutation-thunder-lord': 'âš¡ é›·ç…Œ'
            };
            return names[category] || 'æœªçŸ¥';
        }

        function getTypeName(type) {
            const names = {
                'attack': 'æ”»å‡»',
                'defense': 'é˜²å¾¡',
                'agility': 'æ•æ·',
                'buff': 'å¢ç›Š',
                'debuff': 'å‡ç›Š',
                'heal': 'æ²»ç–—'
            };
            return names[type] || type;
        }

        function getEffectName(effect) {
            const names = {
                'direct_attack': 'ç›´æ¥æ”»å‡»',
                'multi_attack': 'å¤šæ®µæ”»å‡»',
                'dot_damage': 'é™„åŠ ä¼¤å®³',
                'percent_damage': 'ç™¾åˆ†æ¯”ä¼¤å®³',
                'direct_defense': 'ç›´æ¥é˜²å¾¡',
                'continuous_defense': 'æŒç»­é˜²å¾¡',
                'defense_counter': 'é˜²å¾¡åå‡»',
                'direct_speed': 'ç›´æ¥å¢é€Ÿ',
                'continuous_speed': 'æŒç»­å¢é€Ÿ',
                'buff_attack': 'å¢æ”»',
                'buff_defense': 'å¢é˜²',
                'buff_attack_damage': 'æ”»å‡»å¢ä¼¤',
                'buff_attack_defense': 'æ”»å‡»å¢é˜²',
                'buff_attack_speed': 'æ”»å‡»å¢é€Ÿ',
                'buff_attack_status': 'æ”»å‡»å¢ç›Š',
                'buff_defense_damage': 'é˜²å¾¡å¢ä¼¤',
                'buff_defense_speed': 'é˜²å¾¡å¢é€Ÿ',
                'buff_defense_defense': 'é˜²å¾¡å¢é˜²',
                'buff_defense_status': 'é˜²å¾¡å¢ç›Š',
                'buff_speed': 'å¢é€Ÿ',
                'buff_status_enemy': 'æ–½åŠ å¼‚å¸¸',
                'buff_purify': 'å‡€åŒ–',
                'buff_heal_amp': 'å¢åŠ æ²»ç–—',
                'buff_element_damage': 'å±æ€§å¢ä¼¤',
                'debuff_attack': 'å‡æ”»',
                'debuff_defense': 'å‡é˜²',
                'debuff_attack_damage': 'æ”»å‡»å‡ä¼¤',
                'debuff_attack_defense': 'æ”»å‡»å‡é˜²',
                'debuff_attack_speed': 'æ”»å‡»å‡é€Ÿ',
                'debuff_attack_status': 'æ”»å‡»å‡ç›Š',
                'debuff_defense_damage': 'é˜²å¾¡å‡ä¼¤',
                'debuff_defense_defense': 'é˜²å¾¡å‡é˜²',
                'debuff_defense_speed': 'é˜²å¾¡å‡é€Ÿ',
                'debuff_defense_status': 'é˜²å¾¡å‡ç›Š',
                'debuff_speed': 'å‡é€Ÿ',
                'debuff_status_self': 'è‡ªèº«å¼‚å¸¸',
                'debuff_no_heal': 'ç¦ç–—',
                'debuff_heal_reduce': 'å‡ç–—',
                'debuff_element_damage': 'å±æ€§å‡ä¼¤',
                'heal_direct': 'ç›´æ¥æ¢å¤',
                'heal_continuous': 'æŒç»­æ¢å¤',
                'heal_percent': 'ç™¾åˆ†æ¯”æ¢å¤',
                'heal_rebirth': 'é‡ç”Ÿ',
                'heal_lifesteal': 'ç”Ÿå‘½æ±²å–'
            };
            return names[effect] || effect;
        }

        function getStatusName(status) {
            const names = {
                'stun': 'çœ©æ™•',
                'poison': 'ä¸­æ¯’',
                'bleed': 'æµè¡€',
                'frostbite': 'å†»ä¼¤',
                'burn': 'çƒ§ä¼¤',
                'paralyze': 'éº»ç—¹'
            };
            return names[status] || status;
        }

        function getRarityName(rarity) {
            const names = {
                'shiny': 'âœ¨ é—ªå…‰',
                'prismatic': 'ğŸŒˆ å¹»å½©',
                'stellar': 'â­ æ˜ŸèŠ’'
            };
            return names[rarity] || rarity;
        }

        // åˆå§‹åŒ–åº”ç”¨
        init();
    </script>
</body>
</html>